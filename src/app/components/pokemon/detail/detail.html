<div class="min-h-screen bg-gray-50 flex flex-col items-center p-8">

    <button (click)="back()"
        class="self-start mb-8 flex items-center gap-2 px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300 transition text-gray-700 font-medium">
        ‚Üê <span>Back</span>
    </button>

    @if (loading) {
    <div class="flex flex-col items-center justify-center mt-24">
        <div class="animate-spin rounded-full h-12 w-12 border-4 border-pink-400 border-t-transparent mb-4"></div>
        <p class="text-gray-600 text-lg font-medium">Loading Pok√©mon...</p>
    </div>
    } @else if (pokemon) {
    <div class="bg-white p-6 rounded-2xl shadow-md w-full max-w-md text-center">

        <div class="relative w-44 h-44 mx-auto mb-4">
            <img [appLazyImage]="pokemon.sprites?.other['official-artwork'].front_default" [alt]="pokemon.name"
                [class.opacity-0]="isHovered"
                class="absolute inset-0 w-full h-full object-contain transition-opacity duration-300" />
            <img [appLazyImage]="pokemon.sprites?.other['official-artwork'].front_shiny" [alt]="pokemon.name + ' shiny'"
                [class.opacity-100]="isHovered"
                class="absolute inset-0 w-full h-full object-contain opacity-0 transition-opacity duration-300"
                (mouseenter)="isHovered = true" (mouseleave)="isHovered = false" />
        </div>

        <h2 class="text-3xl font-bold text-gray-800 mb-2">{{ pokemon.name | titlecase }}</h2>

        <div class="flex justify-center flex-wrap gap-2 mb-4">
            @for (t of pokemon.types; track t.type.name) {
            <span [ngClass]="
                    (typeColors[t.type.name].bg || 'bg-gray-400') +
                    ' text-white px-3 py-1 rounded-full text-sm font-semibold'
                ">
                {{ t.type.name | titlecase }}
            </span>
            }
        </div>

        <button (click)="playCry()"
            class="px-5 py-2 bg-pink-500 text-white rounded-lg font-medium hover:bg-pink-600 transition mb-6">
            üîä Play Cry
        </button>

        <div class="grid grid-cols-3 gap-4 mb-6">
            <div class="p-3 bg-gray-100 rounded-lg">
                <p class="text-xs text-gray-500">Height</p>
                <p class="text-lg font-semibold text-gray-800">{{ pokemon.height }}</p>
            </div>
            <div class="p-3 bg-gray-100 rounded-lg">
                <p class="text-xs text-gray-500">Weight</p>
                <p class="text-lg font-semibold text-gray-800">{{ pokemon.weight }}</p>
            </div>
            <div class="p-3 bg-gray-100 rounded-lg">
                <p class="text-xs text-gray-500">Exp</p>
                <p class="text-lg font-semibold text-gray-800">{{ pokemon.base_experience }}</p>
            </div>
        </div>

        <div class="mb-5">
            <h3 class="text-sm font-semibold text-gray-700 mb-2">Abilities</h3>
            <div class="flex flex-wrap justify-center gap-2">
                @for (a of pokemon.abilities; track a.ability.name) {
                <span class="bg-gray-100 text-gray-700 px-3 py-1 rounded-md text-sm">
                    {{ a.ability.name | titlecase }}
                </span>
                }
            </div>
        </div>

        <div>
            <h3 class="text-sm font-semibold text-gray-700 mb-2">Stats</h3>

            <div class="space-y-2">
                @for (s of pokemon.stats; track s.stat.name) {
                <div class="text-sm">
                    <div class="flex justify-between mb-1" [ngClass]="typeColors[pokemon.types[0].type.name].text">
                        <span>{{ s.stat.name | titlecase }}</span>
                        <span class="font-semibold">{{ s.base_stat }}</span>
                    </div>

                    <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
                        <div class="h-3 rounded-full transition-all duration-500"
                            [ngClass]="typeColors[pokemon.types[0].type.name].bg"
                            [style.width.%]="(s.base_stat / 255) * 100">
                        </div>
                    </div>
                </div>
                }
            </div>
        </div>

        <div class="mt-8 bg-white p-4 rounded-xl shadow-md w-full max-w-md text-center">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">Evolution Chain</h3>

            <div class="flex flex-wrap justify-center gap-3">
                @for (evo of evolutionChain; track evo) {
                <button (click)="loadEvolution(evo)"
                    class="px-4 py-2 rounded-lg bg-pink-100 text-pink-700 font-medium hover:bg-pink-200 transition">
                    {{ evo | titlecase }}
                </button>
                }
            </div>
        </div>
    </div>
    } @else {
    <p class="text-red-600 text-lg font-medium mt-16">Pok√©mon not found.</p>
    }
</div>